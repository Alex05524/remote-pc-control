/* =========================
   ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ ТЕМЫ
   ========================= */
:root {
  --bg-gradient: radial-gradient(circle at 20% 20%, #233659 0%, #0b1426 45%, #020812 100%);
  --surface: rgba(12, 19, 35, 0.55);
  --surface-strong: rgba(15, 23, 42, 0.82);
  --surface-muted: rgba(11, 18, 32, 0.45);
  --card-border: rgba(59, 130, 246, 0.35);
  --card-border-hover: rgba(56, 189, 248, 0.7);
  --panel-shadow: 0 28px 70px -35px rgba(59, 130, 246, 0.55);
  --panel-shadow-hover: 0 42px 110px -40px rgba(22, 252, 232, 0.45);
  --text-primary: #e2e8f0;
  --text-muted: #94a3b8;
  --text-strong: #f8fafc;
  --accent: linear-gradient(135deg, #60a5fa 0%, #22d3ee 100%);
  --accent-strong: linear-gradient(135deg, #a855f7 0%, #22d3ee 100%);
  --danger: #f87171;
  --success: #34d399;
  --warning: #fbbf24;
  --radius-lg: 22px;
  --radius-md: 16px;
  --radius-sm: 12px;
  --radius-xs: 8px;
  --transition: 0.2s ease;
}

/* ================
   СБРОС / БАЗА
   ================ */
*, *::before, *::after { box-sizing: border-box; }
html, body { height: 100%; margin: 0; }

body {
  font-family: "Segoe UI","Inter","Roboto",sans-serif;
  background: var(--bg-gradient);
  color: var(--text-primary);
  min-height: 100vh;
  background-attachment: fixed;
  display: flex;
  flex-direction: column;
}

a { color: inherit; text-decoration: none; }
button, input, select { font-family: inherit; cursor: pointer; }

/* =========================
   ШАПКА (ИНФО СТАТИСТИКА)
   ========================= */
.topbar {
  background: var(--surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--card-border);
  box-shadow: var(--panel-shadow);
  backdrop-filter: blur(18px);
  padding: 28px 36px;
  margin: 32px auto 24px;
  width: 100%;
  max-width: none;
  padding-inline: 5vw;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 32px;
  transition: border-color var(--transition), box-shadow var(--transition), transform var(--transition);
}

.topbar:hover {
  border-color: var(--card-border-hover);
  box-shadow: var(--panel-shadow-hover);
  transform: translateY(-2px);
}

.brand { display: flex; align-items: center; gap: 16px; }
.logo {
  width: 44px; height: 44px; border-radius: 14px;
  background: var(--accent);
  display: grid; place-items: center;
  font-size: 22px; color:#0f172a; font-weight:600;
  box-shadow: 0 14px 28px -18px rgba(96,165,250,.85);
}

.title h1 { margin:0; font-size:22px; font-weight:600; color:var(--text-strong); }
.subtitle { font-size:14px; color:var(--text-muted); letter-spacing:.03em; text-transform:uppercase; margin-top:3px; }

.stats { display:flex; gap:28px; }
.stat { display:flex; flex-direction:column; gap:6px; }
.stat .label { font-size:13px; color:var(--text-muted); letter-spacing:.04em; text-transform:uppercase; }
.stat .value {
  background: var(--accent); -webkit-background-clip:text; background-clip:text;
  color:transparent; font-weight:700; font-size:26px; line-height:1;
}

/* ==================================
   ЛЕВАЯ КОЛОНКА (СПИСОК ГРУПП / UI)
   ================================== */
.layout { display:grid; grid-template-columns:360px minmax(0,1fr); gap:24px; align-items:start; }
.column-left { display:flex; flex-direction:column; gap:20px; }
.sidebar { padding:24px; }

/* Блок назначения групп */
.assign { display:flex; flex-direction:column; gap:10px; margin-top:auto; }
.assign-label { font-size:13px; text-transform:uppercase; letter-spacing:.05em; color:var(--text-muted); }
.assign-row { display:flex; gap:10px; flex-wrap:wrap; }
.input-select { min-width:160px; flex:1; }

/* ================
   КНОПКИ / ФОРМЫ
   ================ */
.btn.btn-sm { padding:8px 16px; font-size:13px; }

.toolbar {
  background: var(--surface);
  border-radius: var(--radius-lg);
  border:1px solid var(--card-border);
  box-shadow: var(--panel-shadow);
  padding:18px 24px;
  display:flex; justify-content:space-between; align-items:center; gap:18px;
  flex-wrap:wrap; backdrop-filter:blur(18px);
}

.toolbar .left, .toolbar .right {
  display:flex; align-items:center; gap:16px; flex-wrap:wrap;
}

.input {
  background: var(--surface-strong);
  border:1px solid rgba(148,163,184,.25);
  border-radius:999px;
  padding:10px 16px 10px 42px;
  color:var(--text-primary);
  min-width:240px;
  font-size:14px;
  position:relative;
  transition: all var(--transition);
  box-shadow: inset 0 0 0 1px transparent;
}

.input:focus-visible {
  outline:none;
  border-color:rgba(96,165,250,.8);
  box-shadow: inset 0 0 0 1px rgba(59,130,246,.45);
  background:rgba(15,23,42,.9);
}

.check { display:inline-flex; align-items:center; gap:10px; font-size:14px; color:var(--text-muted); }
.check input { width:18px; height:18px; accent-color:#60a5fa; }

.btn {
  border-radius:999px;
  border:1px solid rgba(148,163,184,.3);
  background:rgba(148,163,184,.12);
  color:var(--text-primary);
  padding:10px 18px;
  font-size:14px; font-weight:500;
  display:inline-flex; align-items:center; gap:8px;
  transition: all var(--transition);
  backdrop-filter: blur(8px);
}
.btn:hover { background:rgba(148,163,184,.24); border-color:rgba(226,232,240,.55); transform:translateY(-1px); }
.btn:active { transform:translateY(0); }
.btn-primary {
  border:none; background:var(--accent); color:#0f172a; font-weight:600;
  box-shadow:0 12px 28px -18px rgba(59,130,246,.9);
}
.btn-primary:hover {
  background:var(--accent-strong); color:#f8fafc;
  box-shadow:0 20px 45px -25px rgba(37,99,235,.65);
}
.btn-sm { padding:7px 14px; font-size:13px; }
.btn-danger { border:none; background:rgba(248,113,113,.22); color:#fecaca; }
.btn-danger:hover { background:rgba(248,113,113,.32); color:#fee2e2; }
.btn:disabled { opacity:.45; cursor:not-allowed; transform:none; box-shadow:none; }
.btn-active { background:rgba(56,189,248,.2); border-color:rgba(56,189,248,.5); color:#bae6fd; }
.btn-active:hover { background:rgba(56,189,248,.3); }

/* ===============================
   ОСНОВНАЯ СЕТКА (3 КОЛОНКИ UI)
   =============================== */
.grid {
  display:grid;
  grid-template-columns: 1fr 2fr 1.5fr; /* левая панель / таблица / инфо */
  gap:3vw;
  align-items:start;
}

/* ================
   КАРТОЧКИ / ПАНЕЛИ
   ================ */
.card {
  background: var(--surface);
  border-radius: var(--radius-lg);
  border:1px solid var(--card-border);
  box-shadow: var(--panel-shadow);
  padding:22px 24px;
  display:flex; flex-direction:column; gap:18px;
  transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
  backdrop-filter: blur(18px);
}
.card:hover { border-color:var(--card-border-hover); box-shadow:var(--panel-shadow-hover); transform:translateY(-4px); }
.card-title { font-size:16px; font-weight:600; color:var(--text-strong); display:flex; align-items:center; gap:10px; letter-spacing:.01em; }

.divider { width:1px; height:26px; background:rgba(148,163,184,.22); }

/* =========================
   СПИСОК ГРУПП (ЛЕВАЯ ПАНЕЛЬ)
   ========================= */
.group-list { display:flex; flex-direction:column; gap:12px; margin:0; padding:0; list-style:none; }
.group-item {
  background:rgba(15,23,42,.55);
  border-radius: var(--radius-sm);
  padding:12px 16px;
  border:1px solid transparent;
  color:var(--text-primary);
  display:flex; justify-content:space-between; align-items:center; gap:10px;
  transition: all var(--transition);
}
.group-item:hover { transform:translateX(6px); border-color:rgba(148,163,184,.4); color:#f8fafc; }
.group-item.active {
  background:linear-gradient(135deg,rgba(96,165,250,.28),rgba(56,189,248,.28));
  border-color:rgba(96,165,250,.7);
  color:#f8fafc;
  box-shadow:0 18px 40px -28px rgba(96,165,250,.7);
}
.group-name { font-weight:500; font-size:15px; }
.group-count { font-size:13px; color:var(--text-muted); }

/* =================================
   ТАБЛИЦА КОМПЬЮТЕРОВ (ЦЕНТР ПАНЕЛИ)
   ================================= */
.table-agents {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0 8px;
  table-layout: fixed;
  font-size: 14px;
}

.table-agents col.c-status  { width: 70px; }
.table-agents col.c-host    { width: 42%; }
.table-agents col.c-group   { width: 18%; }
.table-agents col.c-actions { width: 350px; }

.table-agents thead th {
  padding: 10px 14px;
  font-size: 13px;
  font-weight: 600;
  letter-spacing: .05em;
  text-transform: uppercase;
  text-align: left;
  color: var(--text-muted);
  white-space: nowrap;
}

.table-agents tbody tr {
  background: var(--surface-strong);
  border: 1px solid rgba(148,163,184,.16);
  border-radius: 14px;
  overflow: hidden;
  transition: .18s box-shadow, .18s transform, .18s border-color;
}

.table-agents tbody tr:hover {
  transform: translateY(-3px);
  border-color: rgba(96,165,250,.55);
  box-shadow: 0 14px 34px -18px rgba(59,130,246,.45);
}

.table-agents tbody tr.row-link.selected {
  border-color: rgba(96,165,250,.9);
  box-shadow: 0 18px 40px -24px rgba(59,130,246,.55);
}

.table-agents tbody td {
  padding: 14px 16px;
  vertical-align: middle;
  text-align: left;
  white-space: nowrap;
  border: none;
  background: transparent;
}

.table-agents tbody td.status { text-align: center; }

.table-agents tbody td.host {
  white-space: normal;
  word-break: break-word;
  padding-right: 8px;
}

.table-agents tbody td.group {
  overflow: hidden;
  text-overflow: ellipsis;
}

.table-agents tbody td.actions {
  text-align: right;
  white-space: nowrap;
  padding-left: 8px;
}

.table-agents .host-name {
  font-weight: 600;
  font-size: 15px;
  margin-bottom: 4px;
  color: var(--text-primary);
  line-height: 1.2;
}

.table-agents .muted {
  font-size: 12px;
  color: var(--text-muted);
}

.table-agents .status {
  display: flex;
  justify-content: flex-start;
  align-items: center;
  gap: 6px;
}

.table-agents .dot {
  width: 11px;
  height: 11px;
  border-radius: 50%;
  background: #475569;
  position: relative;
}

.table-agents .dot.on {
  background: var(--success);
  animation: pulse-dot 1.8s infinite;
  box-shadow: 0 0 6px 1px rgba(52,211,153,.55);
}

.table-agents .dot.off {
  background: rgba(148,163,184,.4);
}

.table-agents .actions {
  display: inline-flex;
  justify-content: flex-end;
  align-items: center;
  gap: 10px;
}

.table-agents .actions .btn {
  flex: 0 0 auto;
}

@media (max-width: 1250px) {
  .table-agents col.c-host    { width: 40%; }
  .table-agents col.c-group   { width: 16%; }
  .table-agents col.c-actions { width: 210px; }
}

@media (max-width: 980px) {
  .table-agents col.c-actions { width: 190px; }
  .table-agents col.c-group   { width: 20%; }
}

@media (max-width: 820px) {
  /* Мобильная карточная раскладка */
  .table-agents thead { display: none; }
  .table-agents { border-spacing: 0 6px; table-layout: auto; }
  .table-agents tbody tr {
    display: block;
    padding: 10px 14px 12px;
  }
  .table-agents tbody td {
    display: block;
    padding: 6px 0;
    white-space: normal;
    text-align: left;
  }
  .table-agents tbody td.actions {
    margin-top: 10px;
    padding-top: 8px;
    border-top: 1px solid rgba(148,163,184,.12);
    text-align: left;
  }
  .table-agents .actions {
    justify-content: flex-start;
    flex-wrap: wrap;
  }
}

/* ===============================
   ПАНЕЛЬ ИНФОРМАЦИИ (ПРАВАЯ ЧАСТЬ)
   =============================== */
.info-panel { padding:24px; max-height:calc(100vh - 220px); overflow-y:auto; }
.info-panel .info { display:block; overflow:visible; max-width:100%; word-break:break-word; }
.info-view {
  background:rgba(15,23,42,.55);
  border-radius: var(--radius-md);
  padding:20px;
  border:1px solid rgba(148,163,184,.18);
  min-height:320px;
  display:flex; flex-direction:column; gap:18px;
}
.placeholder { text-align:center; color:var(--text-muted); font-size:14px; padding:60px 20px; }

.agent-header { display:flex; justify-content:space-between; align-items:flex-start; gap:16px; }
.agent-title { display:flex; flex-direction:column; gap:4px; }
.agent-name { font-size:20px; font-weight:600; color:var(--text-strong); }
.agent-sub { font-size:13px; }
.agent-badges { display:flex; gap:8px; flex-wrap:wrap; }

.chip {
  background:rgba(148,163,184,.18);
  border-radius:999px;
  padding:6px 12px;
  font-size:12px;
  text-transform:uppercase;
  letter-spacing:.05em;
  color:var(--text-muted);
}
.chip-on { background:rgba(52,211,153,.22); color:#6ee7b7; }
.chip-admin { background:rgba(250,204,21,.22); color:#fcd34d; }

.section { display:flex; flex-direction:column; gap:12px; }
.section h4 {
  font-size:13px; text-transform:uppercase;
  letter-spacing:.06em; color:var(--text-muted); margin:0;
}

.kv {
  display:grid;
  grid-template-columns: minmax(120px,180px) minmax(0,1fr);
  gap:10px 18px; margin:0;
}
.kv dt { font-size:13px; color:var(--text-muted); align-self:center; }
.kv dd { margin:0; font-size:14px; color:var(--text-primary); }

.mono {
  font-family:"JetBrains Mono","Fira Code","Cascadia Code",monospace;
  font-size:13px;
  background:rgba(15,23,42,.65);
  padding:3px 6px;
  border-radius: var(--radius-xs);
  border:1px solid rgba(148,163,184,.2);
  letter-spacing:.02em;
}

.pills { display:flex; flex-wrap:wrap; gap:6px; }
.pill {
  background:rgba(96,165,250,.22);
  border:1px solid rgba(96,165,250,.5);
  border-radius:999px;
  padding:4px 10px;
  font-size:12px;
  color:rgba(191,219,254,.95);
  letter-spacing:.02em;
}

/* ==========
   ПОДВАЛ
   ========== */
.footer {
  background:transparent;
  color:var(--text-muted);
  text-align:center;
  padding:40px 0 28px;
  font-size:13px;
  letter-spacing:.02em;
}

/* ======================
   МОДАЛЬНЫЕ ОКНА / FILE
   ====================== */
.modal {
  position:fixed; inset:0;
  background:rgba(2,8,18,.78);
  display:grid; place-items:center;
  padding:40px 24px; z-index:40;
  backdrop-filter:blur(14px);
}
.modal.hidden { display:none; }
.modal-content {
  background:var(--surface);
  border-radius: var(--radius-lg);
  border:1px solid var(--card-border);
  box-shadow: var(--panel-shadow-hover);
  padding:28px;
  width:min(480px,92vw);
  display:flex; flex-direction:column; gap:18px;
}
.modal-title { font-size:18px; font-weight:600; color:var(--text-strong); margin:0; }
.modal-actions { display:flex; justify-content:flex-end; gap:12px; }

.offline-banner {
  background:rgba(248,113,113,.18);
  border:1px solid rgba(248,113,113,.38);
  border-radius: var(--radius-md);
  padding:12px 16px;
  color:#fecaca; font-size:13px;
}

.badge-group {
  background:rgba(129,140,248,.18);
  border:1px solid rgba(129,140,248,.4);
  color:#c7d2fe;
}

/* Поле поиска со значком */
.search-wrapper { position:relative; }
.search-wrapper::before {
  content:"🔍";
  position:absolute;
  inset-block:0; left:16px;
  display:flex; align-items:center;
  font-size:16px;
  color:rgba(148,163,184,.5);
}

/* ==========
   АНИМАЦИИ
   ========== */
@keyframes pulse-dot {
  0% { box-shadow:0 0 0 0 rgba(52,211,153,.6); }
  50% { box-shadow:0 0 0 12px rgba(52,211,153,0); }
  100% { box-shadow:0 0 0 0 rgba(52,211,153,0); }
}

/* ======================
   АДАПТИВ (ПЕРЕЛОМЫ)
   ====================== */
@media (max-width:1150px) {
  .layout { grid-template-columns:minmax(0,1fr); }
  .column-left { flex-direction:column; }
  .assign-row { flex-direction:column; align-items:stretch; }
}

@media (max-width:780px) {
  .assign-row { flex-direction:column; align-items:stretch; }
  .topbar {
    width: min(3540px, 98vw);
    flex-direction:column; text-align:center;
  }
  .stats { width:100%; justify-content:center; }
  .toolbar { flex-direction:column; align-items:stretch; }
  .toolbar .left, .toolbar .right { width:100%; justify-content:center; }
  .input { width:100%; }
  .grid { grid-template-columns:minmax(0,1fr); }
  .info-panel { max-height:none; overflow:visible; }
  .card, .toolbar, .topbar { padding-inline:20px; }
  .table tbody td { padding:12px 14px; }
}

/* === OFFLINE PAGE LAYOUT === */
.grid-offline > .offline-list {
  width: 100%;
  max-width: 100%;
  justify-self: start;   /* чтобы не растягивался */
}
@media (max-width: 1050px){
  .grid-offline { grid-template-columns: minmax(0,1fr); }
  .info-panel { max-height:none; overflow:visible; }
}

/* === TABLE OFFLINE (colgroup based) === */
.table-offline {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0 10px;
  table-layout: fixed;
  font-size: 14px;
}

.table-offline col.c-host    { width: 44%; }
.table-offline col.c-group   { width: 16%; }
.table-offline col.c-last    { width: 22%; }
.table-offline col.c-actions { width: 180px; }

.table-offline thead th {
  padding: 10px 14px;
  font-size: 13px;
  font-weight: 600;
  letter-spacing: .05em;
  text-transform: uppercase;
  text-align: left;
  color: var(--text-muted);
  white-space: nowrap;
}

.table-offline tbody tr {
  background: var(--surface-strong);
  border: 1px solid rgba(148,163,184,.16);
  border-radius: 14px;
  overflow: hidden;
  transition: .18s box-shadow, .18s transform, .18s border-color;
}

.table-offline tbody tr:hover {
  transform: translateY(-3px);
  border-color: rgba(96,165,250,.55);
  box-shadow: 0 14px 34px -18px rgba(59,130,246,.45);
}

.table-offline tbody tr.row-link.selected {
  border-color: rgba(96,165,250,.9);
  box-shadow: 0 18px 40px -24px rgba(59,130,246,.55);
}

.table-offline tbody td {
  padding: 14px 16px;
  vertical-align: middle;
  background: transparent;
  border: none;
  white-space: nowrap;
  text-align: left;
}

.table-offline tbody td.host { white-space: normal; word-break: break-word; }
.table-offline tbody td.actions { text-align: right; }

.table-offline .host-name { font-weight:600; font-size:15px; line-height:1.2; margin-bottom:4px; }
.table-offline .muted { font-size:12px; color:var(--text-muted); }
.table-offline .actions {
  display: inline-flex;
  justify-content: flex-end;
  align-items: center;
  gap: 10px;
}

@media (max-width: 900px){
  .table-offline col.c-actions { width:160px; }
  .table-offline col.c-last { width: 26%; }
}

@media (max-width: 780px){
  .table-offline thead { display:none; }
  .table-offline { border-spacing:0 6px; table-layout:auto; }
  .table-offline tbody tr { display:block; padding:10px 14px 12px; }
  .table-offline tbody td { display:block; padding:6px 0; white-space:normal; }
  .table-offline tbody td.actions {
    margin-top:8px; text-align:left;
    border-top:1px solid rgba(148,163,184,.12); padding-top:10px;
  }
  .table-offline .actions { justify-content:flex-start; flex-wrap:wrap; }
}

.file-toolbar {
  display:flex; align-items:center; gap:8px; flex-wrap:wrap; margin-bottom:8px;
}
.breadcrumbs { display:flex; flex-wrap:wrap; gap:4px; font-size:12px; }
.breadcrumbs .crumb { cursor:pointer; color:var(--accent, #3b82f6); }
.breadcrumbs .sep { opacity:.5; }
.file-panel { border:1px solid rgba(148,163,184,.16); border-radius:8px; overflow:hidden; background:var(--surface-strong); }
.file-head { display:grid; grid-template-columns: 34px 1fr 100px 110px 130px; gap:0; background:rgba(148,163,184,.08); align-items:stretch; }
.file-head .hcol { background:transparent; border:none; cursor:pointer; font:inherit; font-size:12px; letter-spacing:.05em; text-transform:uppercase; padding:6px 8px; text-align:left; color:var(--text-muted); }
.file-head .hcol:hover { background:rgba(255,255,255,.06); }
.file-head .chk-col { display:flex; justify-content:center; align-items:center; }
.file-body { max-height:420px; overflow:auto; font-size:13px; }
.f-row { display:grid; grid-template-columns: 34px 1fr 100px 110px 130px; padding:4px 6px; align-items:center; cursor:pointer; border-bottom:1px solid rgba(148,163,184,.08); }
.f-row:last-child { border-bottom:none; }
.f-row:hover { background:rgba(59,130,246,.08); }
.f-row.sel { background:rgba(59,130,246,.18); }
.f-ico { width:20px; text-align:center; }
.f-name { display:flex; align-items:center; gap:6px; min-width:0; }
.f-name span.txt { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.mono { font-family:ui-monospace,Consolas,monospace; }
.col-size, .col-type, .col-mtime { font-variant-numeric: tabular-nums; }
.editing { background:rgba(59,130,246,.18); }
.inline-edit { width:100%; font:inherit; padding:2px 4px; }
.upload-bar { margin-top:10px; display:flex; gap:10px; align-items:center; }
.transfer-area { margin-top:10px; display:flex; flex-direction:column; gap:6px; }
.xfer { padding:6px 10px; background:rgba(148,163,184,.08); border-radius:6px; font-size:12px; }
.xfer-bar { height:5px; background:rgba(255,255,255,.08); border-radius:4px; overflow:hidden; margin-top:4px; }
.xfer-fill { height:100%; background:#3b82f6; width:0%; transition:.2s width; }
.ctx { position:fixed; z-index:100; list-style:none; margin:0; padding:4px 0; background:#1e293b; border:1px solid rgba(255,255,255,.12); border-radius:8px; width:160px; font-size:13px; }
.ctx.hidden { display:none; }
.ctx li { padding:6px 12px; cursor:pointer; }
.ctx li:hover { background:#2563eb; color:#fff; }
.ctx li.danger:hover { background:#dc2626; }